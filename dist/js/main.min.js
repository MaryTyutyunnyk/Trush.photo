$(function () {
	$("#arrow").on("click", function () {
		$(".infoSectionDescription").toggleClass('openDescription');
		$(".infoSectionDescription__arrow").toggleClass('arrowUp')
	});
});


$(function () {
	$("#homePageSliderList").owlCarousel({
		items: 1,
		loop: true,
		autoplay: true,
		autoplayTimeout: 3000,
		autoplayHoverPause: true,
		animateOut: 'slideOutUp',
		animateIn: 'slideInUp',
		mouseDrag: false,
		touchDrag: false,
		pullDrag: false,
		freeDrag: false,
	});
});

$(function () {

// Эту функцию надо как-то связать с переключением языков на сайте.
// function translateValidationMessages(currentLang) {
// 	message = {
// 		en: {
// 			required: 'Required field',
// 			minlength: $.validator.format('Please enter at least {0} characters'),
// 			customPhone: 'Please enter correct phone',
// 		},
// 		uk: {
// 			required: 'Поле обов\'язкове для заповнення',
// 			minlength: $.validator.format('Будь ласка, введіть не менше {0} символів'),
// 			customPhone: 'Будь ласка, введіть коректний номер телефону',
// 		},
// 		ru: {
// 			required: 'Поле обязательно для заполнения',
// 			minlength: $.validator.format('Пожалуйста, введите не менее {0} символов'),
// 			customPhone: 'Пожалуйста, введите корректный номер телефона',
// 		}
// 	};
// 	console.log('Translating validation messages to: ' + currentLang);
//
// 	if (currentLang == 'uk') {
// 		$.extend($.validator.messages, message.uk);
// 	} else if (currentLang == 'ru') {
// 		$.extend($.validator.messages, message.ru);
// 	} else {
// 		$.extend($.validator.messages, message.en);
// 	}
// }

	$.validator.setDefaults({
		submitHandler: function () {
			$('.brief__box')
				.css({'display': 'none'});
			$('.briefSent')
				.css({'display': 'block'});
		},
		highlight: function (element) {
			$(element)
				.closest('.briefForm__input')
				.addClass('errorBorder');
		},
		unhighlight: function (element) {
			$(element)
				.closest('.briefForm__input')
				.removeClass('errorBorder');
		}
	});

	$.validator.addMethod("customEmail", function (value, element) {
		return this.optional(element) || /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(value);
	}, 'Пожалуйста, введите корректный адрес электронной почты');

	$.validator.addMethod("customPhone", function (value, element) {
		console.log(value);
		value = value.replace(/\s+/g, "");
		return this.optional(element) || /^(?!\+.*\(.*\).*\-\-.*$)(?!\+.*\(.*\).*\-$)(([0-9]{0,11})?( [0-9]{3})?( [0-9]{3})?( [0-9]{2})?( [0-9]{2})?(\([0-9]{3})?(\)[0-9]{3})?([-]{0,1})?([0-9]{0,2})?([-]{0,1})?([0-9]{0,2})?( [0-9]{2})?( [0-9]{2})?(\+[0-9]{1,11})?( [0-9]{3})?( [0-9]{3})?( [0-9]{2})?( [0-9]{2})?(\([0-9]{3})?(\)[0-9]{3})?([-]{0,1})?([0-9]{0,2})?([-]{0,1})?([0-9]{0,2})?( [0-9]{2})?( [0-9]{2})?)$/gim.test(value);
	}, 'Пожалуйста, введите корректный номер телефона');

	$('#briefForm').validate({
		rules: {
			name: {
				required: true,
				minlength: 2,
			},
			phone: {
				required: true,
				customPhone: true,
				minlength: 10,
			},
			email: {
				required: true,
				email: true,
				customEmail: true,
			},
			product: {
				required: true,
			}
		},
		messages: {
			name: {
				required: 'Поле обязательно для заполнения',
				minlength: $.validator.format('Пожалуйста, введите не менее {0} символов'),
			},
			phone: {
				required: 'Поле обязательно для заполнения',
				customPhone: 'Пожалуйста, введите корректный номер телефона',
				minlength: $.validator.format('Пожалуйста, введите не менее {0} символов'),
			},
			email: {
				required: 'Поле обязательно для заполнения',
				email: 'Пожалуйста, введите корректный адрес электронной почты',
				customEmail: 'Пожалуйста, введите корректный адрес электронной почты'
			},
			product: {
				required: 'Поле обязательно для заполнения',
			}
		},
		errorClass: 'errorMessage',
	});
});

$(function () {
	// Function for brief pop-up

	$(".navbarMenu__btn").on('click', function () {
		$(".brief").css({"display": "block"});
	});

	$(".brief__crossButton").on('click', function () {
		$(".brief").css({"display": "none"});
	});
});
$(function () {

	let $grid = $('.interior__masonry').imagesLoaded(function () {
		// init Masonry after all images have loaded
		$grid.masonry({
			// options
			itemSelector: '.interior__item',
			columnWidth: '.grid-sizer',
			gutter: '.gutter-sizer ',
			percentPosition: true,
			horizontalOrder: true,
			isResizeBound: true
		});
	});

	let interiorButton = $(".interior__btn");
	let bubblesAnimation = $(".interior__bubbles");

	interiorButton.click(function () {
		bubblesAnimation.css("display", "flex"); // animation showing
		setTimeout(function () {
			bubblesAnimation.fadeOut(300); // animation hiding after 2s and with the delay - 300ms
		}, 2000);
	});
});
$(function () {
	let $gridGallery = $('.interiorGallery__masonry').imagesLoaded(function () {
		// init Masonry after all images have loaded
		$gridGallery.masonry({
			// options
			itemSelector: '.interiorGallery__item',
			columnWidth: '.grid-sizer',
			gutter: '.gutter-sizer ',
			percentPosition: true,
			horizontalOrder: true
		});
	});
});
$(function () {

	$('#navbarBurger').click(function (e) {
		e.stopPropagation();
		$(this).toggleClass('open');
		$('.navbarMenu').toggleClass('navbarMenu_open');
	});


	let navbarNavLink = $(".navbarNav__link");
	navbarNavLink.click(function () {
		$(".navbarNav__link.navbarNav__link_active").removeClass("navbarNav__link_active");
		$(this).addClass("navbarNav__link_active");
	});


	let navbarLanguageLink = $(".navbarLanguage__link");
	navbarLanguageLink.click(function () {
		$(".navbarLanguage__link.navbarLanguage__link_active").removeClass("navbarLanguage__link_active");
		$(this).addClass("navbarLanguage__link_active");
	});
});


// $("#lang").change(function() {
//     translateValidationMessages(this.value);
//     console.log("Setting language to " + this.value);
// });
$(function () {

// Function for portfolio submenu demonstration

	$('#portfolioItem').click(function (event) {
		event.stopPropagation();
		$('.navbarNavSubMenu').toggleClass('open');
		$(".navbarNav__arrow").toggleClass('arrowUp');
		$('.navbarLanguageDesktopSubMenu').removeClass("open");
	});

	$('html').click(function () {
		$('.navbarNavSubMenu').removeClass("open");
		$(".navbarNav__arrow").removeClass('arrowUp');
	});


// Function for language submenu demonstration

	$('#navbarLanguageDesktopLink').click(function (event) {
		event.stopPropagation();
		$('.navbarLanguageDesktopSubMenu').toggleClass('open');
		$(".navbarLanguageDesktop__arrow").toggleClass('upArrow');
		$('.navbarNavSubMenu').removeClass("open");
	});

	$('html').click(function () {
		$('.navbarLanguageDesktopSubMenu').removeClass("open");
		$(".navbarLanguageDesktop__arrow").removeClass('upArrow');
	});
});



$(function () {

// portfolioBlockImage carousel initiation
	let carouselListImageInitiated = false;
	const prevArrow = $('#previous_arrow');
	const nextArrow = $('#next_arrow');
	const owlCarouselListImage = $('#carouselListImage');
	const $window = $(window);

	const initCarouselListImage = () => {
		owlCarouselListImage.owlCarousel({
			autoWidth: true,
			loop: true,
			dots: false,
			responsiveClass: true,
			responsive: {
				0: {
					loop: false,
				},
				960: {
					loop: true,
				},
			}
		});
		prevArrow.click(function () {
			owlCarouselListImage.trigger('prev.owl.carousel');
		});
		nextArrow.click(function () {
			owlCarouselListImage.trigger('next.owl.carousel');
		});
		owlCarouselListImage.on('changed.owl.carousel', function (event) {
			const {item: {count, index}} = event;
			if (index === 0) {
				prevArrow.hide();
			} else {
				prevArrow.show();
			}
		});
		carouselListImageInitiated = true;
	};
	initCarouselListImage();

// Remove portfolioBlockImage carousel on mobile devices

	$window.resize(function () {
		if ($window.width() < 960) {
			if (carouselListImageInitiated) {
				owlCarouselListImage.trigger('destroy.owl.carousel');
				carouselListImageInitiated = false;
			}
		} else {
			if (!carouselListImageInitiated) {
				initCarouselListImage();
			}
		}
	});


// portfolioBlockCatalogue carousel initiation
	let carouselListCatalogueInitiated = false;
	const prevArrow2 = $('#left_arrow');
	const nextArrow2 = $('#right_arrow');
	const owlCarouselListCatalogue = $('#carouselListCatalogue');

	const initCarouselListCatalogue = () => {
		owlCarouselListCatalogue.owlCarousel({
			autoWidth: true,
			loop: true,
			dots: false,
			responsiveClass: true,
			responsive: {
				0: {
					loop: false,
				},
				960: {
					loop: true,
				},
			}
		});
		prevArrow2.click(function () {
			owlCarouselListCatalogue.trigger('prev.owl.carousel');
		});
		nextArrow2.click(function () {
			owlCarouselListCatalogue.trigger('next.owl.carousel');
		});
		owlCarouselListCatalogue.on('changed.owl.carousel', function (event) {
			const {item: {count, index}} = event;
			if (index === 0) {
				prevArrow2.hide();
			} else {
				prevArrow2.show();
			}
		});
		carouselListCatalogueInitiated = true;
	};
	initCarouselListCatalogue();

// Remove PortfolioBlockCatalogue on mobile devices

	$window.resize(function () {
		if ($window.width() < 960) {
			if (carouselListCatalogueInitiated) {
				owlCarouselListCatalogue.trigger('destroy.owl.carousel');
				carouselListCatalogueInitiated = false;
			}
		} else {
			if (!carouselListCatalogueInitiated) {
				initCarouselListCatalogue();
			}
		}
	});


// Function for modal window

	const addListeners = element => {
		element.on('click', function () {
			$(".modal").css({"display": "block"});
			const id = $(this).data().id;

			//removing all owl modal carousel items
			$('.modalCarouselList__item').each(element => {
				owlModalCarousel.trigger('remove.owl.carousel', element);
				owlModalCarousel.trigger('refresh.owl.carousel');
			});

			$.ajax({
				type: "GET",
				url: `http://photo.apolokhov.in.ua/getimagemigx?resid=${id}`,
				error: function (data, textStatus) {

				},
				success: function (data) {
					// adding new loaded items
					data.forEach(({title, image}, index) => {
						owlModalCarousel.trigger('add.owl.carousel', [
							`<li class="modalCarouselList__item">
								<img src=".${image}" alt="${title}" class="modalCarouselList__img">
							</li>`
						], index);
					})
				},
			});
		});
	};

	const imgBox = $(".carouselItem__imgBox");
	addListeners(imgBox);


	$(".modal__crossBlock").on('click', function () {
		$(".modal").css({"display": "none"});
	});


// Function for modalCarousel

	const modalArrowPrevious = $('#modalArrowPrevious');
	const modalArrowNext = $('#modalArrowNext');
	const owlModalCarousel = $('#modalCarouselList');
	owlModalCarousel.owlCarousel({
		items: 1,
		loop: true,
		dots: false,
		mouseDrag: false,
		touchDrag: false,
		pullDrag: false,
		freeDrag: false,
		responsiveClass: true,
		responsive: {
			0: {
				touchDrag: true,
			},
			960: {
				touchDrag: false,
			},
		}
	});
	modalArrowPrevious.click(function () {
		owlModalCarousel.trigger('prev.owl.carousel');
	});
	modalArrowNext.click(function () {
		owlModalCarousel.trigger('next.owl.carousel');
	});
});





$(function () {

	let publicationsCarouselListInitiated = false;
	const prevArrow = $('#prev_arrow');
	const nextArrow = $('#next_arrow');
	const owlPublicationsCarouselList = $('#publicationsCarouselList');
	const $window = $(window);

	const initPublicationsCarouselList = () => {
		owlPublicationsCarouselList.owlCarousel({
			autoWidth: true,
			dots: false,
		});
		prevArrow.click(function () {
			owlPublicationsCarouselList.trigger('prev.owl.carousel');
		});
		nextArrow.click(function () {
			owlPublicationsCarouselList.trigger('next.owl.carousel');
		});
		owlPublicationsCarouselList.on('changed.owl.carousel', function (event) {
			const {item: {count, index}} = event;
			if (index === 0) {
				prevArrow.hide();
				$('.publicationsCarousel').removeClass('active');
			} else {
				prevArrow.show();
				$('.publicationsCarousel').addClass('active');
			}
		});
		publicationsCarouselListInitiated = true;
	};
	initPublicationsCarouselList();

// Remove function on mobile devices

	$window.resize(function () {
		if ($window.width() < 960) {
			if (publicationsCarouselListInitiated) {
				owlPublicationsCarouselList.trigger('destroy.owl.carousel');
				publicationsCarouselListInitiated = false;
			}
		} else {
			if (!publicationsCarouselListInitiated) {
				initPublicationsCarouselList();
			}
		}
	});

// Filter function
	let publicationsFilterLink = $(".publicationsFilter__link");
	publicationsFilterLink.click(function () {
		$(".publicationsFilter__link.publicationsFilter__link_active")
			.removeClass("publicationsFilter__link_active");
		$(this).addClass("publicationsFilter__link_active");

		const filter = $(this).data('filter'); // determines which tab is clicked
		owlPublicationsCarouselList.trigger('to.owl.carousel', [0, 0]);

		$(".owl-carousel .publicationsCarouselItem").each(function () {
			// if the picture data attribute 'data-filter' match to the tab attribute 'data-attr' with value 'all', then all pictures are shown
			if (filter === 'all' || $(this).data('attr') === filter) {
				$(this).show();
			} else {
				$(this).hide();
			}
		});
	});
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFib3V0LmpzIiwiaW5kZXguanMiLCJpbnRlcmlvci5qcyIsImludGVyaW9yR2FsbGVyeS5qcyIsIm1lbnUuanMiLCJuYXZiYXIuanMiLCJwb3J0Zm9saW8uanMiLCJwdWJsaWNhdGlvbnMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKGZ1bmN0aW9uICgpIHtcclxuXHQkKFwiI2Fycm93XCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG5cdFx0JChcIi5pbmZvU2VjdGlvbkRlc2NyaXB0aW9uXCIpLnRvZ2dsZUNsYXNzKCdvcGVuRGVzY3JpcHRpb24nKTtcclxuXHRcdCQoXCIuaW5mb1NlY3Rpb25EZXNjcmlwdGlvbl9fYXJyb3dcIikudG9nZ2xlQ2xhc3MoJ2Fycm93VXAnKVxyXG5cdH0pO1xyXG59KTtcclxuXHJcbiIsIiQoZnVuY3Rpb24gKCkge1xyXG5cdCQoXCIjaG9tZVBhZ2VTbGlkZXJMaXN0XCIpLm93bENhcm91c2VsKHtcclxuXHRcdGl0ZW1zOiAxLFxyXG5cdFx0bG9vcDogdHJ1ZSxcclxuXHRcdGF1dG9wbGF5OiB0cnVlLFxyXG5cdFx0YXV0b3BsYXlUaW1lb3V0OiAzMDAwLFxyXG5cdFx0YXV0b3BsYXlIb3ZlclBhdXNlOiB0cnVlLFxyXG5cdFx0YW5pbWF0ZU91dDogJ3NsaWRlT3V0VXAnLFxyXG5cdFx0YW5pbWF0ZUluOiAnc2xpZGVJblVwJyxcclxuXHRcdG1vdXNlRHJhZzogZmFsc2UsXHJcblx0XHR0b3VjaERyYWc6IGZhbHNlLFxyXG5cdFx0cHVsbERyYWc6IGZhbHNlLFxyXG5cdFx0ZnJlZURyYWc6IGZhbHNlLFxyXG5cdH0pO1xyXG59KTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG5cclxuLy8g0K3RgtGDINGE0YPQvdC60YbQuNGOINC90LDQtNC+INC60LDQui3RgtC+INGB0LLRj9C30LDRgtGMINGBINC/0LXRgNC10LrQu9GO0YfQtdC90LjQtdC8INGP0LfRi9C60L7QsiDQvdCwINGB0LDQudGC0LUuXHJcbi8vIGZ1bmN0aW9uIHRyYW5zbGF0ZVZhbGlkYXRpb25NZXNzYWdlcyhjdXJyZW50TGFuZykge1xyXG4vLyBcdG1lc3NhZ2UgPSB7XHJcbi8vIFx0XHRlbjoge1xyXG4vLyBcdFx0XHRyZXF1aXJlZDogJ1JlcXVpcmVkIGZpZWxkJyxcclxuLy8gXHRcdFx0bWlubGVuZ3RoOiAkLnZhbGlkYXRvci5mb3JtYXQoJ1BsZWFzZSBlbnRlciBhdCBsZWFzdCB7MH0gY2hhcmFjdGVycycpLFxyXG4vLyBcdFx0XHRjdXN0b21QaG9uZTogJ1BsZWFzZSBlbnRlciBjb3JyZWN0IHBob25lJyxcclxuLy8gXHRcdH0sXHJcbi8vIFx0XHR1azoge1xyXG4vLyBcdFx0XHRyZXF1aXJlZDogJ9Cf0L7Qu9C1INC+0LHQvtCyXFwn0Y/Qt9C60L7QstC1INC00LvRjyDQt9Cw0L/QvtCy0L3QtdC90L3RjycsXHJcbi8vIFx0XHRcdG1pbmxlbmd0aDogJC52YWxpZGF0b3IuZm9ybWF0KCfQkdGD0LTRjCDQu9Cw0YHQutCwLCDQstCy0LXQtNGW0YLRjCDQvdC1INC80LXQvdGI0LUgezB9INGB0LjQvNCy0L7Qu9GW0LInKSxcclxuLy8gXHRcdFx0Y3VzdG9tUGhvbmU6ICfQkdGD0LTRjCDQu9Cw0YHQutCwLCDQstCy0LXQtNGW0YLRjCDQutC+0YDQtdC60YLQvdC40Lkg0L3QvtC80LXRgCDRgtC10LvQtdGE0L7QvdGDJyxcclxuLy8gXHRcdH0sXHJcbi8vIFx0XHRydToge1xyXG4vLyBcdFx0XHRyZXF1aXJlZDogJ9Cf0L7Qu9C1INC+0LHRj9C30LDRgtC10LvRjNC90L4g0LTQu9GPINC30LDQv9C+0LvQvdC10L3QuNGPJyxcclxuLy8gXHRcdFx0bWlubGVuZ3RoOiAkLnZhbGlkYXRvci5mb3JtYXQoJ9Cf0L7QttCw0LvRg9C50YHRgtCwLCDQstCy0LXQtNC40YLQtSDQvdC1INC80LXQvdC10LUgezB9INGB0LjQvNCy0L7Qu9C+0LInKSxcclxuLy8gXHRcdFx0Y3VzdG9tUGhvbmU6ICfQn9C+0LbQsNC70YPQudGB0YLQsCwg0LLQstC10LTQuNGC0LUg0LrQvtGA0YDQtdC60YLQvdGL0Lkg0L3QvtC80LXRgCDRgtC10LvQtdGE0L7QvdCwJyxcclxuLy8gXHRcdH1cclxuLy8gXHR9O1xyXG4vLyBcdGNvbnNvbGUubG9nKCdUcmFuc2xhdGluZyB2YWxpZGF0aW9uIG1lc3NhZ2VzIHRvOiAnICsgY3VycmVudExhbmcpO1xyXG4vL1xyXG4vLyBcdGlmIChjdXJyZW50TGFuZyA9PSAndWsnKSB7XHJcbi8vIFx0XHQkLmV4dGVuZCgkLnZhbGlkYXRvci5tZXNzYWdlcywgbWVzc2FnZS51ayk7XHJcbi8vIFx0fSBlbHNlIGlmIChjdXJyZW50TGFuZyA9PSAncnUnKSB7XHJcbi8vIFx0XHQkLmV4dGVuZCgkLnZhbGlkYXRvci5tZXNzYWdlcywgbWVzc2FnZS5ydSk7XHJcbi8vIFx0fSBlbHNlIHtcclxuLy8gXHRcdCQuZXh0ZW5kKCQudmFsaWRhdG9yLm1lc3NhZ2VzLCBtZXNzYWdlLmVuKTtcclxuLy8gXHR9XHJcbi8vIH1cclxuXHJcblx0JC52YWxpZGF0b3Iuc2V0RGVmYXVsdHMoe1xyXG5cdFx0c3VibWl0SGFuZGxlcjogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHQkKCcuYnJpZWZfX2JveCcpXHJcblx0XHRcdFx0LmNzcyh7J2Rpc3BsYXknOiAnbm9uZSd9KTtcclxuXHRcdFx0JCgnLmJyaWVmU2VudCcpXHJcblx0XHRcdFx0LmNzcyh7J2Rpc3BsYXknOiAnYmxvY2snfSk7XHJcblx0XHR9LFxyXG5cdFx0aGlnaGxpZ2h0OiBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG5cdFx0XHQkKGVsZW1lbnQpXHJcblx0XHRcdFx0LmNsb3Nlc3QoJy5icmllZkZvcm1fX2lucHV0JylcclxuXHRcdFx0XHQuYWRkQ2xhc3MoJ2Vycm9yQm9yZGVyJyk7XHJcblx0XHR9LFxyXG5cdFx0dW5oaWdobGlnaHQ6IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcblx0XHRcdCQoZWxlbWVudClcclxuXHRcdFx0XHQuY2xvc2VzdCgnLmJyaWVmRm9ybV9faW5wdXQnKVxyXG5cdFx0XHRcdC5yZW1vdmVDbGFzcygnZXJyb3JCb3JkZXInKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0JC52YWxpZGF0b3IuYWRkTWV0aG9kKFwiY3VzdG9tRW1haWxcIiwgZnVuY3Rpb24gKHZhbHVlLCBlbGVtZW50KSB7XHJcblx0XHRyZXR1cm4gdGhpcy5vcHRpb25hbChlbGVtZW50KSB8fCAvXltBLVowLTkuXyUrLV0rQFtBLVowLTkuLV0rXFwuW0EtWl17Miw0fSQvaS50ZXN0KHZhbHVlKTtcclxuXHR9LCAn0J/QvtC20LDQu9GD0LnRgdGC0LAsINCy0LLQtdC00LjRgtC1INC60L7RgNGA0LXQutGC0L3Ri9C5INCw0LTRgNC10YEg0Y3Qu9C10LrRgtGA0L7QvdC90L7QuSDQv9C+0YfRgtGLJyk7XHJcblxyXG5cdCQudmFsaWRhdG9yLmFkZE1ldGhvZChcImN1c3RvbVBob25lXCIsIGZ1bmN0aW9uICh2YWx1ZSwgZWxlbWVudCkge1xyXG5cdFx0Y29uc29sZS5sb2codmFsdWUpO1xyXG5cdFx0dmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9cXHMrL2csIFwiXCIpO1xyXG5cdFx0cmV0dXJuIHRoaXMub3B0aW9uYWwoZWxlbWVudCkgfHwgL14oPyFcXCsuKlxcKC4qXFwpLipcXC1cXC0uKiQpKD8hXFwrLipcXCguKlxcKS4qXFwtJCkoKFswLTldezAsMTF9KT8oIFswLTldezN9KT8oIFswLTldezN9KT8oIFswLTldezJ9KT8oIFswLTldezJ9KT8oXFwoWzAtOV17M30pPyhcXClbMC05XXszfSk/KFstXXswLDF9KT8oWzAtOV17MCwyfSk/KFstXXswLDF9KT8oWzAtOV17MCwyfSk/KCBbMC05XXsyfSk/KCBbMC05XXsyfSk/KFxcK1swLTldezEsMTF9KT8oIFswLTldezN9KT8oIFswLTldezN9KT8oIFswLTldezJ9KT8oIFswLTldezJ9KT8oXFwoWzAtOV17M30pPyhcXClbMC05XXszfSk/KFstXXswLDF9KT8oWzAtOV17MCwyfSk/KFstXXswLDF9KT8oWzAtOV17MCwyfSk/KCBbMC05XXsyfSk/KCBbMC05XXsyfSk/KSQvZ2ltLnRlc3QodmFsdWUpO1xyXG5cdH0sICfQn9C+0LbQsNC70YPQudGB0YLQsCwg0LLQstC10LTQuNGC0LUg0LrQvtGA0YDQtdC60YLQvdGL0Lkg0L3QvtC80LXRgCDRgtC10LvQtdGE0L7QvdCwJyk7XHJcblxyXG5cdCQoJyNicmllZkZvcm0nKS52YWxpZGF0ZSh7XHJcblx0XHRydWxlczoge1xyXG5cdFx0XHRuYW1lOiB7XHJcblx0XHRcdFx0cmVxdWlyZWQ6IHRydWUsXHJcblx0XHRcdFx0bWlubGVuZ3RoOiAyLFxyXG5cdFx0XHR9LFxyXG5cdFx0XHRwaG9uZToge1xyXG5cdFx0XHRcdHJlcXVpcmVkOiB0cnVlLFxyXG5cdFx0XHRcdGN1c3RvbVBob25lOiB0cnVlLFxyXG5cdFx0XHRcdG1pbmxlbmd0aDogMTAsXHJcblx0XHRcdH0sXHJcblx0XHRcdGVtYWlsOiB7XHJcblx0XHRcdFx0cmVxdWlyZWQ6IHRydWUsXHJcblx0XHRcdFx0ZW1haWw6IHRydWUsXHJcblx0XHRcdFx0Y3VzdG9tRW1haWw6IHRydWUsXHJcblx0XHRcdH0sXHJcblx0XHRcdHByb2R1Y3Q6IHtcclxuXHRcdFx0XHRyZXF1aXJlZDogdHJ1ZSxcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdG1lc3NhZ2VzOiB7XHJcblx0XHRcdG5hbWU6IHtcclxuXHRcdFx0XHRyZXF1aXJlZDogJ9Cf0L7Qu9C1INC+0LHRj9C30LDRgtC10LvRjNC90L4g0LTQu9GPINC30LDQv9C+0LvQvdC10L3QuNGPJyxcclxuXHRcdFx0XHRtaW5sZW5ndGg6ICQudmFsaWRhdG9yLmZvcm1hdCgn0J/QvtC20LDQu9GD0LnRgdGC0LAsINCy0LLQtdC00LjRgtC1INC90LUg0LzQtdC90LXQtSB7MH0g0YHQuNC80LLQvtC70L7QsicpLFxyXG5cdFx0XHR9LFxyXG5cdFx0XHRwaG9uZToge1xyXG5cdFx0XHRcdHJlcXVpcmVkOiAn0J/QvtC70LUg0L7QsdGP0LfQsNGC0LXQu9GM0L3QviDQtNC70Y8g0LfQsNC/0L7Qu9C90LXQvdC40Y8nLFxyXG5cdFx0XHRcdGN1c3RvbVBob25lOiAn0J/QvtC20LDQu9GD0LnRgdGC0LAsINCy0LLQtdC00LjRgtC1INC60L7RgNGA0LXQutGC0L3Ri9C5INC90L7QvNC10YAg0YLQtdC70LXRhNC+0L3QsCcsXHJcblx0XHRcdFx0bWlubGVuZ3RoOiAkLnZhbGlkYXRvci5mb3JtYXQoJ9Cf0L7QttCw0LvRg9C50YHRgtCwLCDQstCy0LXQtNC40YLQtSDQvdC1INC80LXQvdC10LUgezB9INGB0LjQvNCy0L7Qu9C+0LInKSxcclxuXHRcdFx0fSxcclxuXHRcdFx0ZW1haWw6IHtcclxuXHRcdFx0XHRyZXF1aXJlZDogJ9Cf0L7Qu9C1INC+0LHRj9C30LDRgtC10LvRjNC90L4g0LTQu9GPINC30LDQv9C+0LvQvdC10L3QuNGPJyxcclxuXHRcdFx0XHRlbWFpbDogJ9Cf0L7QttCw0LvRg9C50YHRgtCwLCDQstCy0LXQtNC40YLQtSDQutC+0YDRgNC10LrRgtC90YvQuSDQsNC00YDQtdGBINGN0LvQtdC60YLRgNC+0L3QvdC+0Lkg0L/QvtGH0YLRiycsXHJcblx0XHRcdFx0Y3VzdG9tRW1haWw6ICfQn9C+0LbQsNC70YPQudGB0YLQsCwg0LLQstC10LTQuNGC0LUg0LrQvtGA0YDQtdC60YLQvdGL0Lkg0LDQtNGA0LXRgSDRjdC70LXQutGC0YDQvtC90L3QvtC5INC/0L7Rh9GC0YsnXHJcblx0XHRcdH0sXHJcblx0XHRcdHByb2R1Y3Q6IHtcclxuXHRcdFx0XHRyZXF1aXJlZDogJ9Cf0L7Qu9C1INC+0LHRj9C30LDRgtC10LvRjNC90L4g0LTQu9GPINC30LDQv9C+0LvQvdC10L3QuNGPJyxcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdGVycm9yQ2xhc3M6ICdlcnJvck1lc3NhZ2UnLFxyXG5cdH0pO1xyXG59KTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG5cdC8vIEZ1bmN0aW9uIGZvciBicmllZiBwb3AtdXBcclxuXHJcblx0JChcIi5uYXZiYXJNZW51X19idG5cIikub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG5cdFx0JChcIi5icmllZlwiKS5jc3Moe1wiZGlzcGxheVwiOiBcImJsb2NrXCJ9KTtcclxuXHR9KTtcclxuXHJcblx0JChcIi5icmllZl9fY3Jvc3NCdXR0b25cIikub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG5cdFx0JChcIi5icmllZlwiKS5jc3Moe1wiZGlzcGxheVwiOiBcIm5vbmVcIn0pO1xyXG5cdH0pO1xyXG59KTsiLCIkKGZ1bmN0aW9uICgpIHtcclxuXHJcblx0bGV0ICRncmlkID0gJCgnLmludGVyaW9yX19tYXNvbnJ5JykuaW1hZ2VzTG9hZGVkKGZ1bmN0aW9uICgpIHtcclxuXHRcdC8vIGluaXQgTWFzb25yeSBhZnRlciBhbGwgaW1hZ2VzIGhhdmUgbG9hZGVkXHJcblx0XHQkZ3JpZC5tYXNvbnJ5KHtcclxuXHRcdFx0Ly8gb3B0aW9uc1xyXG5cdFx0XHRpdGVtU2VsZWN0b3I6ICcuaW50ZXJpb3JfX2l0ZW0nLFxyXG5cdFx0XHRjb2x1bW5XaWR0aDogJy5ncmlkLXNpemVyJyxcclxuXHRcdFx0Z3V0dGVyOiAnLmd1dHRlci1zaXplciAnLFxyXG5cdFx0XHRwZXJjZW50UG9zaXRpb246IHRydWUsXHJcblx0XHRcdGhvcml6b250YWxPcmRlcjogdHJ1ZSxcclxuXHRcdFx0aXNSZXNpemVCb3VuZDogdHJ1ZVxyXG5cdFx0fSk7XHJcblx0fSk7XHJcblxyXG5cdGxldCBpbnRlcmlvckJ1dHRvbiA9ICQoXCIuaW50ZXJpb3JfX2J0blwiKTtcclxuXHRsZXQgYnViYmxlc0FuaW1hdGlvbiA9ICQoXCIuaW50ZXJpb3JfX2J1YmJsZXNcIik7XHJcblxyXG5cdGludGVyaW9yQnV0dG9uLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuXHRcdGJ1YmJsZXNBbmltYXRpb24uY3NzKFwiZGlzcGxheVwiLCBcImZsZXhcIik7IC8vIGFuaW1hdGlvbiBzaG93aW5nXHJcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0YnViYmxlc0FuaW1hdGlvbi5mYWRlT3V0KDMwMCk7IC8vIGFuaW1hdGlvbiBoaWRpbmcgYWZ0ZXIgMnMgYW5kIHdpdGggdGhlIGRlbGF5IC0gMzAwbXNcclxuXHRcdH0sIDIwMDApO1xyXG5cdH0pO1xyXG59KTsiLCIkKGZ1bmN0aW9uICgpIHtcclxuXHRsZXQgJGdyaWRHYWxsZXJ5ID0gJCgnLmludGVyaW9yR2FsbGVyeV9fbWFzb25yeScpLmltYWdlc0xvYWRlZChmdW5jdGlvbiAoKSB7XHJcblx0XHQvLyBpbml0IE1hc29ucnkgYWZ0ZXIgYWxsIGltYWdlcyBoYXZlIGxvYWRlZFxyXG5cdFx0JGdyaWRHYWxsZXJ5Lm1hc29ucnkoe1xyXG5cdFx0XHQvLyBvcHRpb25zXHJcblx0XHRcdGl0ZW1TZWxlY3RvcjogJy5pbnRlcmlvckdhbGxlcnlfX2l0ZW0nLFxyXG5cdFx0XHRjb2x1bW5XaWR0aDogJy5ncmlkLXNpemVyJyxcclxuXHRcdFx0Z3V0dGVyOiAnLmd1dHRlci1zaXplciAnLFxyXG5cdFx0XHRwZXJjZW50UG9zaXRpb246IHRydWUsXHJcblx0XHRcdGhvcml6b250YWxPcmRlcjogdHJ1ZVxyXG5cdFx0fSk7XHJcblx0fSk7XHJcbn0pOyIsIiQoZnVuY3Rpb24gKCkge1xyXG5cclxuXHQkKCcjbmF2YmFyQnVyZ2VyJykuY2xpY2soZnVuY3Rpb24gKGUpIHtcclxuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHQkKHRoaXMpLnRvZ2dsZUNsYXNzKCdvcGVuJyk7XHJcblx0XHQkKCcubmF2YmFyTWVudScpLnRvZ2dsZUNsYXNzKCduYXZiYXJNZW51X29wZW4nKTtcclxuXHR9KTtcclxuXHJcblxyXG5cdGxldCBuYXZiYXJOYXZMaW5rID0gJChcIi5uYXZiYXJOYXZfX2xpbmtcIik7XHJcblx0bmF2YmFyTmF2TGluay5jbGljayhmdW5jdGlvbiAoKSB7XHJcblx0XHQkKFwiLm5hdmJhck5hdl9fbGluay5uYXZiYXJOYXZfX2xpbmtfYWN0aXZlXCIpLnJlbW92ZUNsYXNzKFwibmF2YmFyTmF2X19saW5rX2FjdGl2ZVwiKTtcclxuXHRcdCQodGhpcykuYWRkQ2xhc3MoXCJuYXZiYXJOYXZfX2xpbmtfYWN0aXZlXCIpO1xyXG5cdH0pO1xyXG5cclxuXHJcblx0bGV0IG5hdmJhckxhbmd1YWdlTGluayA9ICQoXCIubmF2YmFyTGFuZ3VhZ2VfX2xpbmtcIik7XHJcblx0bmF2YmFyTGFuZ3VhZ2VMaW5rLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuXHRcdCQoXCIubmF2YmFyTGFuZ3VhZ2VfX2xpbmsubmF2YmFyTGFuZ3VhZ2VfX2xpbmtfYWN0aXZlXCIpLnJlbW92ZUNsYXNzKFwibmF2YmFyTGFuZ3VhZ2VfX2xpbmtfYWN0aXZlXCIpO1xyXG5cdFx0JCh0aGlzKS5hZGRDbGFzcyhcIm5hdmJhckxhbmd1YWdlX19saW5rX2FjdGl2ZVwiKTtcclxuXHR9KTtcclxufSk7XHJcblxyXG5cclxuLy8gJChcIiNsYW5nXCIpLmNoYW5nZShmdW5jdGlvbigpIHtcclxuLy8gICAgIHRyYW5zbGF0ZVZhbGlkYXRpb25NZXNzYWdlcyh0aGlzLnZhbHVlKTtcclxuLy8gICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBsYW5ndWFnZSB0byBcIiArIHRoaXMudmFsdWUpO1xyXG4vLyB9KTsiLCIkKGZ1bmN0aW9uICgpIHtcclxuXHJcbi8vIEZ1bmN0aW9uIGZvciBwb3J0Zm9saW8gc3VibWVudSBkZW1vbnN0cmF0aW9uXHJcblxyXG5cdCQoJyNwb3J0Zm9saW9JdGVtJykuY2xpY2soZnVuY3Rpb24gKGV2ZW50KSB7XHJcblx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdCQoJy5uYXZiYXJOYXZTdWJNZW51JykudG9nZ2xlQ2xhc3MoJ29wZW4nKTtcclxuXHRcdCQoXCIubmF2YmFyTmF2X19hcnJvd1wiKS50b2dnbGVDbGFzcygnYXJyb3dVcCcpO1xyXG5cdFx0JCgnLm5hdmJhckxhbmd1YWdlRGVza3RvcFN1Yk1lbnUnKS5yZW1vdmVDbGFzcyhcIm9wZW5cIik7XHJcblx0fSk7XHJcblxyXG5cdCQoJ2h0bWwnKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcblx0XHQkKCcubmF2YmFyTmF2U3ViTWVudScpLnJlbW92ZUNsYXNzKFwib3BlblwiKTtcclxuXHRcdCQoXCIubmF2YmFyTmF2X19hcnJvd1wiKS5yZW1vdmVDbGFzcygnYXJyb3dVcCcpO1xyXG5cdH0pO1xyXG5cclxuXHJcbi8vIEZ1bmN0aW9uIGZvciBsYW5ndWFnZSBzdWJtZW51IGRlbW9uc3RyYXRpb25cclxuXHJcblx0JCgnI25hdmJhckxhbmd1YWdlRGVza3RvcExpbmsnKS5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0JCgnLm5hdmJhckxhbmd1YWdlRGVza3RvcFN1Yk1lbnUnKS50b2dnbGVDbGFzcygnb3BlbicpO1xyXG5cdFx0JChcIi5uYXZiYXJMYW5ndWFnZURlc2t0b3BfX2Fycm93XCIpLnRvZ2dsZUNsYXNzKCd1cEFycm93Jyk7XHJcblx0XHQkKCcubmF2YmFyTmF2U3ViTWVudScpLnJlbW92ZUNsYXNzKFwib3BlblwiKTtcclxuXHR9KTtcclxuXHJcblx0JCgnaHRtbCcpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuXHRcdCQoJy5uYXZiYXJMYW5ndWFnZURlc2t0b3BTdWJNZW51JykucmVtb3ZlQ2xhc3MoXCJvcGVuXCIpO1xyXG5cdFx0JChcIi5uYXZiYXJMYW5ndWFnZURlc2t0b3BfX2Fycm93XCIpLnJlbW92ZUNsYXNzKCd1cEFycm93Jyk7XHJcblx0fSk7XHJcbn0pO1xyXG5cclxuXHJcbiIsIiQoZnVuY3Rpb24gKCkge1xyXG5cclxuLy8gcG9ydGZvbGlvQmxvY2tJbWFnZSBjYXJvdXNlbCBpbml0aWF0aW9uXHJcblx0bGV0IGNhcm91c2VsTGlzdEltYWdlSW5pdGlhdGVkID0gZmFsc2U7XHJcblx0Y29uc3QgcHJldkFycm93ID0gJCgnI3ByZXZpb3VzX2Fycm93Jyk7XHJcblx0Y29uc3QgbmV4dEFycm93ID0gJCgnI25leHRfYXJyb3cnKTtcclxuXHRjb25zdCBvd2xDYXJvdXNlbExpc3RJbWFnZSA9ICQoJyNjYXJvdXNlbExpc3RJbWFnZScpO1xyXG5cdGNvbnN0ICR3aW5kb3cgPSAkKHdpbmRvdyk7XHJcblxyXG5cdGNvbnN0IGluaXRDYXJvdXNlbExpc3RJbWFnZSA9ICgpID0+IHtcclxuXHRcdG93bENhcm91c2VsTGlzdEltYWdlLm93bENhcm91c2VsKHtcclxuXHRcdFx0YXV0b1dpZHRoOiB0cnVlLFxyXG5cdFx0XHRsb29wOiB0cnVlLFxyXG5cdFx0XHRkb3RzOiBmYWxzZSxcclxuXHRcdFx0cmVzcG9uc2l2ZUNsYXNzOiB0cnVlLFxyXG5cdFx0XHRyZXNwb25zaXZlOiB7XHJcblx0XHRcdFx0MDoge1xyXG5cdFx0XHRcdFx0bG9vcDogZmFsc2UsXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHQ5NjA6IHtcclxuXHRcdFx0XHRcdGxvb3A6IHRydWUsXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRwcmV2QXJyb3cuY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRvd2xDYXJvdXNlbExpc3RJbWFnZS50cmlnZ2VyKCdwcmV2Lm93bC5jYXJvdXNlbCcpO1xyXG5cdFx0fSk7XHJcblx0XHRuZXh0QXJyb3cuY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRvd2xDYXJvdXNlbExpc3RJbWFnZS50cmlnZ2VyKCduZXh0Lm93bC5jYXJvdXNlbCcpO1xyXG5cdFx0fSk7XHJcblx0XHRvd2xDYXJvdXNlbExpc3RJbWFnZS5vbignY2hhbmdlZC5vd2wuY2Fyb3VzZWwnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHRcdFx0Y29uc3Qge2l0ZW06IHtjb3VudCwgaW5kZXh9fSA9IGV2ZW50O1xyXG5cdFx0XHRpZiAoaW5kZXggPT09IDApIHtcclxuXHRcdFx0XHRwcmV2QXJyb3cuaGlkZSgpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHByZXZBcnJvdy5zaG93KCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0Y2Fyb3VzZWxMaXN0SW1hZ2VJbml0aWF0ZWQgPSB0cnVlO1xyXG5cdH07XHJcblx0aW5pdENhcm91c2VsTGlzdEltYWdlKCk7XHJcblxyXG4vLyBSZW1vdmUgcG9ydGZvbGlvQmxvY2tJbWFnZSBjYXJvdXNlbCBvbiBtb2JpbGUgZGV2aWNlc1xyXG5cclxuXHQkd2luZG93LnJlc2l6ZShmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAoJHdpbmRvdy53aWR0aCgpIDwgOTYwKSB7XHJcblx0XHRcdGlmIChjYXJvdXNlbExpc3RJbWFnZUluaXRpYXRlZCkge1xyXG5cdFx0XHRcdG93bENhcm91c2VsTGlzdEltYWdlLnRyaWdnZXIoJ2Rlc3Ryb3kub3dsLmNhcm91c2VsJyk7XHJcblx0XHRcdFx0Y2Fyb3VzZWxMaXN0SW1hZ2VJbml0aWF0ZWQgPSBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0aWYgKCFjYXJvdXNlbExpc3RJbWFnZUluaXRpYXRlZCkge1xyXG5cdFx0XHRcdGluaXRDYXJvdXNlbExpc3RJbWFnZSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cclxuLy8gcG9ydGZvbGlvQmxvY2tDYXRhbG9ndWUgY2Fyb3VzZWwgaW5pdGlhdGlvblxyXG5cdGxldCBjYXJvdXNlbExpc3RDYXRhbG9ndWVJbml0aWF0ZWQgPSBmYWxzZTtcclxuXHRjb25zdCBwcmV2QXJyb3cyID0gJCgnI2xlZnRfYXJyb3cnKTtcclxuXHRjb25zdCBuZXh0QXJyb3cyID0gJCgnI3JpZ2h0X2Fycm93Jyk7XHJcblx0Y29uc3Qgb3dsQ2Fyb3VzZWxMaXN0Q2F0YWxvZ3VlID0gJCgnI2Nhcm91c2VsTGlzdENhdGFsb2d1ZScpO1xyXG5cclxuXHRjb25zdCBpbml0Q2Fyb3VzZWxMaXN0Q2F0YWxvZ3VlID0gKCkgPT4ge1xyXG5cdFx0b3dsQ2Fyb3VzZWxMaXN0Q2F0YWxvZ3VlLm93bENhcm91c2VsKHtcclxuXHRcdFx0YXV0b1dpZHRoOiB0cnVlLFxyXG5cdFx0XHRsb29wOiB0cnVlLFxyXG5cdFx0XHRkb3RzOiBmYWxzZSxcclxuXHRcdFx0cmVzcG9uc2l2ZUNsYXNzOiB0cnVlLFxyXG5cdFx0XHRyZXNwb25zaXZlOiB7XHJcblx0XHRcdFx0MDoge1xyXG5cdFx0XHRcdFx0bG9vcDogZmFsc2UsXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHQ5NjA6IHtcclxuXHRcdFx0XHRcdGxvb3A6IHRydWUsXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRwcmV2QXJyb3cyLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0b3dsQ2Fyb3VzZWxMaXN0Q2F0YWxvZ3VlLnRyaWdnZXIoJ3ByZXYub3dsLmNhcm91c2VsJyk7XHJcblx0XHR9KTtcclxuXHRcdG5leHRBcnJvdzIuY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRvd2xDYXJvdXNlbExpc3RDYXRhbG9ndWUudHJpZ2dlcignbmV4dC5vd2wuY2Fyb3VzZWwnKTtcclxuXHRcdH0pO1xyXG5cdFx0b3dsQ2Fyb3VzZWxMaXN0Q2F0YWxvZ3VlLm9uKCdjaGFuZ2VkLm93bC5jYXJvdXNlbCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG5cdFx0XHRjb25zdCB7aXRlbToge2NvdW50LCBpbmRleH19ID0gZXZlbnQ7XHJcblx0XHRcdGlmIChpbmRleCA9PT0gMCkge1xyXG5cdFx0XHRcdHByZXZBcnJvdzIuaGlkZSgpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHByZXZBcnJvdzIuc2hvdygpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdGNhcm91c2VsTGlzdENhdGFsb2d1ZUluaXRpYXRlZCA9IHRydWU7XHJcblx0fTtcclxuXHRpbml0Q2Fyb3VzZWxMaXN0Q2F0YWxvZ3VlKCk7XHJcblxyXG4vLyBSZW1vdmUgUG9ydGZvbGlvQmxvY2tDYXRhbG9ndWUgb24gbW9iaWxlIGRldmljZXNcclxuXHJcblx0JHdpbmRvdy5yZXNpemUoZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKCR3aW5kb3cud2lkdGgoKSA8IDk2MCkge1xyXG5cdFx0XHRpZiAoY2Fyb3VzZWxMaXN0Q2F0YWxvZ3VlSW5pdGlhdGVkKSB7XHJcblx0XHRcdFx0b3dsQ2Fyb3VzZWxMaXN0Q2F0YWxvZ3VlLnRyaWdnZXIoJ2Rlc3Ryb3kub3dsLmNhcm91c2VsJyk7XHJcblx0XHRcdFx0Y2Fyb3VzZWxMaXN0Q2F0YWxvZ3VlSW5pdGlhdGVkID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGlmICghY2Fyb3VzZWxMaXN0Q2F0YWxvZ3VlSW5pdGlhdGVkKSB7XHJcblx0XHRcdFx0aW5pdENhcm91c2VsTGlzdENhdGFsb2d1ZSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cclxuLy8gRnVuY3Rpb24gZm9yIG1vZGFsIHdpbmRvd1xyXG5cclxuXHRjb25zdCBhZGRMaXN0ZW5lcnMgPSBlbGVtZW50ID0+IHtcclxuXHRcdGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHQkKFwiLm1vZGFsXCIpLmNzcyh7XCJkaXNwbGF5XCI6IFwiYmxvY2tcIn0pO1xyXG5cdFx0XHRjb25zdCBpZCA9ICQodGhpcykuZGF0YSgpLmlkO1xyXG5cclxuXHRcdFx0Ly9yZW1vdmluZyBhbGwgb3dsIG1vZGFsIGNhcm91c2VsIGl0ZW1zXHJcblx0XHRcdCQoJy5tb2RhbENhcm91c2VsTGlzdF9faXRlbScpLmVhY2goZWxlbWVudCA9PiB7XHJcblx0XHRcdFx0b3dsTW9kYWxDYXJvdXNlbC50cmlnZ2VyKCdyZW1vdmUub3dsLmNhcm91c2VsJywgZWxlbWVudCk7XHJcblx0XHRcdFx0b3dsTW9kYWxDYXJvdXNlbC50cmlnZ2VyKCdyZWZyZXNoLm93bC5jYXJvdXNlbCcpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdCQuYWpheCh7XHJcblx0XHRcdFx0dHlwZTogXCJHRVRcIixcclxuXHRcdFx0XHR1cmw6IGBodHRwOi8vcGhvdG8uYXBvbG9raG92LmluLnVhL2dldGltYWdlbWlneD9yZXNpZD0ke2lkfWAsXHJcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uIChkYXRhLCB0ZXh0U3RhdHVzKSB7XHJcblxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcclxuXHRcdFx0XHRcdC8vIGFkZGluZyBuZXcgbG9hZGVkIGl0ZW1zXHJcblx0XHRcdFx0XHRkYXRhLmZvckVhY2goKHt0aXRsZSwgaW1hZ2V9LCBpbmRleCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRvd2xNb2RhbENhcm91c2VsLnRyaWdnZXIoJ2FkZC5vd2wuY2Fyb3VzZWwnLCBbXHJcblx0XHRcdFx0XHRcdFx0YDxsaSBjbGFzcz1cIm1vZGFsQ2Fyb3VzZWxMaXN0X19pdGVtXCI+XHJcblx0XHRcdFx0XHRcdFx0XHQ8aW1nIHNyYz1cIi4ke2ltYWdlfVwiIGFsdD1cIiR7dGl0bGV9XCIgY2xhc3M9XCJtb2RhbENhcm91c2VsTGlzdF9faW1nXCI+XHJcblx0XHRcdFx0XHRcdFx0PC9saT5gXHJcblx0XHRcdFx0XHRcdF0sIGluZGV4KTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBpbWdCb3ggPSAkKFwiLmNhcm91c2VsSXRlbV9faW1nQm94XCIpO1xyXG5cdGFkZExpc3RlbmVycyhpbWdCb3gpO1xyXG5cclxuXHJcblx0JChcIi5tb2RhbF9fY3Jvc3NCbG9ja1wiKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcblx0XHQkKFwiLm1vZGFsXCIpLmNzcyh7XCJkaXNwbGF5XCI6IFwibm9uZVwifSk7XHJcblx0fSk7XHJcblxyXG5cclxuLy8gRnVuY3Rpb24gZm9yIG1vZGFsQ2Fyb3VzZWxcclxuXHJcblx0Y29uc3QgbW9kYWxBcnJvd1ByZXZpb3VzID0gJCgnI21vZGFsQXJyb3dQcmV2aW91cycpO1xyXG5cdGNvbnN0IG1vZGFsQXJyb3dOZXh0ID0gJCgnI21vZGFsQXJyb3dOZXh0Jyk7XHJcblx0Y29uc3Qgb3dsTW9kYWxDYXJvdXNlbCA9ICQoJyNtb2RhbENhcm91c2VsTGlzdCcpO1xyXG5cdG93bE1vZGFsQ2Fyb3VzZWwub3dsQ2Fyb3VzZWwoe1xyXG5cdFx0aXRlbXM6IDEsXHJcblx0XHRsb29wOiB0cnVlLFxyXG5cdFx0ZG90czogZmFsc2UsXHJcblx0XHRtb3VzZURyYWc6IGZhbHNlLFxyXG5cdFx0dG91Y2hEcmFnOiBmYWxzZSxcclxuXHRcdHB1bGxEcmFnOiBmYWxzZSxcclxuXHRcdGZyZWVEcmFnOiBmYWxzZSxcclxuXHRcdHJlc3BvbnNpdmVDbGFzczogdHJ1ZSxcclxuXHRcdHJlc3BvbnNpdmU6IHtcclxuXHRcdFx0MDoge1xyXG5cdFx0XHRcdHRvdWNoRHJhZzogdHJ1ZSxcclxuXHRcdFx0fSxcclxuXHRcdFx0OTYwOiB7XHJcblx0XHRcdFx0dG91Y2hEcmFnOiBmYWxzZSxcclxuXHRcdFx0fSxcclxuXHRcdH1cclxuXHR9KTtcclxuXHRtb2RhbEFycm93UHJldmlvdXMuY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cdFx0b3dsTW9kYWxDYXJvdXNlbC50cmlnZ2VyKCdwcmV2Lm93bC5jYXJvdXNlbCcpO1xyXG5cdH0pO1xyXG5cdG1vZGFsQXJyb3dOZXh0LmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuXHRcdG93bE1vZGFsQ2Fyb3VzZWwudHJpZ2dlcignbmV4dC5vd2wuY2Fyb3VzZWwnKTtcclxuXHR9KTtcclxufSk7XHJcblxyXG5cclxuXHJcblxyXG4iLCIkKGZ1bmN0aW9uICgpIHtcclxuXHJcblx0bGV0IHB1YmxpY2F0aW9uc0Nhcm91c2VsTGlzdEluaXRpYXRlZCA9IGZhbHNlO1xyXG5cdGNvbnN0IHByZXZBcnJvdyA9ICQoJyNwcmV2X2Fycm93Jyk7XHJcblx0Y29uc3QgbmV4dEFycm93ID0gJCgnI25leHRfYXJyb3cnKTtcclxuXHRjb25zdCBvd2xQdWJsaWNhdGlvbnNDYXJvdXNlbExpc3QgPSAkKCcjcHVibGljYXRpb25zQ2Fyb3VzZWxMaXN0Jyk7XHJcblx0Y29uc3QgJHdpbmRvdyA9ICQod2luZG93KTtcclxuXHJcblx0Y29uc3QgaW5pdFB1YmxpY2F0aW9uc0Nhcm91c2VsTGlzdCA9ICgpID0+IHtcclxuXHRcdG93bFB1YmxpY2F0aW9uc0Nhcm91c2VsTGlzdC5vd2xDYXJvdXNlbCh7XHJcblx0XHRcdGF1dG9XaWR0aDogdHJ1ZSxcclxuXHRcdFx0ZG90czogZmFsc2UsXHJcblx0XHR9KTtcclxuXHRcdHByZXZBcnJvdy5jbGljayhmdW5jdGlvbiAoKSB7XHJcblx0XHRcdG93bFB1YmxpY2F0aW9uc0Nhcm91c2VsTGlzdC50cmlnZ2VyKCdwcmV2Lm93bC5jYXJvdXNlbCcpO1xyXG5cdFx0fSk7XHJcblx0XHRuZXh0QXJyb3cuY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRvd2xQdWJsaWNhdGlvbnNDYXJvdXNlbExpc3QudHJpZ2dlcignbmV4dC5vd2wuY2Fyb3VzZWwnKTtcclxuXHRcdH0pO1xyXG5cdFx0b3dsUHVibGljYXRpb25zQ2Fyb3VzZWxMaXN0Lm9uKCdjaGFuZ2VkLm93bC5jYXJvdXNlbCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG5cdFx0XHRjb25zdCB7aXRlbToge2NvdW50LCBpbmRleH19ID0gZXZlbnQ7XHJcblx0XHRcdGlmIChpbmRleCA9PT0gMCkge1xyXG5cdFx0XHRcdHByZXZBcnJvdy5oaWRlKCk7XHJcblx0XHRcdFx0JCgnLnB1YmxpY2F0aW9uc0Nhcm91c2VsJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHByZXZBcnJvdy5zaG93KCk7XHJcblx0XHRcdFx0JCgnLnB1YmxpY2F0aW9uc0Nhcm91c2VsJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHB1YmxpY2F0aW9uc0Nhcm91c2VsTGlzdEluaXRpYXRlZCA9IHRydWU7XHJcblx0fTtcclxuXHRpbml0UHVibGljYXRpb25zQ2Fyb3VzZWxMaXN0KCk7XHJcblxyXG4vLyBSZW1vdmUgZnVuY3Rpb24gb24gbW9iaWxlIGRldmljZXNcclxuXHJcblx0JHdpbmRvdy5yZXNpemUoZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKCR3aW5kb3cud2lkdGgoKSA8IDk2MCkge1xyXG5cdFx0XHRpZiAocHVibGljYXRpb25zQ2Fyb3VzZWxMaXN0SW5pdGlhdGVkKSB7XHJcblx0XHRcdFx0b3dsUHVibGljYXRpb25zQ2Fyb3VzZWxMaXN0LnRyaWdnZXIoJ2Rlc3Ryb3kub3dsLmNhcm91c2VsJyk7XHJcblx0XHRcdFx0cHVibGljYXRpb25zQ2Fyb3VzZWxMaXN0SW5pdGlhdGVkID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGlmICghcHVibGljYXRpb25zQ2Fyb3VzZWxMaXN0SW5pdGlhdGVkKSB7XHJcblx0XHRcdFx0aW5pdFB1YmxpY2F0aW9uc0Nhcm91c2VsTGlzdCgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG4vLyBGaWx0ZXIgZnVuY3Rpb25cclxuXHRsZXQgcHVibGljYXRpb25zRmlsdGVyTGluayA9ICQoXCIucHVibGljYXRpb25zRmlsdGVyX19saW5rXCIpO1xyXG5cdHB1YmxpY2F0aW9uc0ZpbHRlckxpbmsuY2xpY2soZnVuY3Rpb24gKCkge1xyXG5cdFx0JChcIi5wdWJsaWNhdGlvbnNGaWx0ZXJfX2xpbmsucHVibGljYXRpb25zRmlsdGVyX19saW5rX2FjdGl2ZVwiKVxyXG5cdFx0XHQucmVtb3ZlQ2xhc3MoXCJwdWJsaWNhdGlvbnNGaWx0ZXJfX2xpbmtfYWN0aXZlXCIpO1xyXG5cdFx0JCh0aGlzKS5hZGRDbGFzcyhcInB1YmxpY2F0aW9uc0ZpbHRlcl9fbGlua19hY3RpdmVcIik7XHJcblxyXG5cdFx0Y29uc3QgZmlsdGVyID0gJCh0aGlzKS5kYXRhKCdmaWx0ZXInKTsgLy8gZGV0ZXJtaW5lcyB3aGljaCB0YWIgaXMgY2xpY2tlZFxyXG5cdFx0b3dsUHVibGljYXRpb25zQ2Fyb3VzZWxMaXN0LnRyaWdnZXIoJ3RvLm93bC5jYXJvdXNlbCcsIFswLCAwXSk7XHJcblxyXG5cdFx0JChcIi5vd2wtY2Fyb3VzZWwgLnB1YmxpY2F0aW9uc0Nhcm91c2VsSXRlbVwiKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0Ly8gaWYgdGhlIHBpY3R1cmUgZGF0YSBhdHRyaWJ1dGUgJ2RhdGEtZmlsdGVyJyBtYXRjaCB0byB0aGUgdGFiIGF0dHJpYnV0ZSAnZGF0YS1hdHRyJyB3aXRoIHZhbHVlICdhbGwnLCB0aGVuIGFsbCBwaWN0dXJlcyBhcmUgc2hvd25cclxuXHRcdFx0aWYgKGZpbHRlciA9PT0gJ2FsbCcgfHwgJCh0aGlzKS5kYXRhKCdhdHRyJykgPT09IGZpbHRlcikge1xyXG5cdFx0XHRcdCQodGhpcykuc2hvdygpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdCQodGhpcykuaGlkZSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9KTtcclxufSk7XHJcbiJdfQ==
